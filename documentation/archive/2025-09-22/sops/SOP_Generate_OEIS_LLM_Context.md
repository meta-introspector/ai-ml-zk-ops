# SOP: Generating OEIS LLM Context File

## 1. Purpose

This Standard Operating Procedure (SOP) details the process of generating a comprehensive LLM (Large Language Model) context file for the "On-Line Encyclopedia of Integer Sequences" (OEIS). This context file aggregates relevant information, such as Wikipedia content, extracted keywords, and related links, to provide a rich dataset for LLM training or inference.

## 2. Scope

This SOP applies to anyone responsible for generating or updating the OEIS LLM context file within the project's Nix-based build system.

## 3. Prerequisites

-   A working Nix environment.
-   The `nix-llm-context` flake and its dependencies are correctly set up.
-   The `generate_oeis_llm_txt.sh` script is present and executable.
-   The `debug_wrapper.sh` script is present and executable.
-   The `Online_Encyclopedia_of_Integer_Sequences.html` file is available in the `wikipedia_cache/` directory.
-   `extract_meaningful_keywords.sh` and `all_extracted_links.md` are available in the `docs/memes/` directory of the main project.

## 4. Procedure

The `nix-llm-context/generate_oeis_llm_txt.sh` script is executed indirectly through a Nix build process, orchestrated by the `nix-llm-context/flake.nix` and `nix-llm-context/debug_wrapper.sh` files.

### 4.1. Script Location

The primary script is located at: `/data/data/com.termux.nix/files/home/pick-up-nix2/source/github/meta-introspector/streamofrandom/2025/09/22/nix-llm-context/generate_oeis_llm_txt.sh`

### 4.2. Execution via Nix Build

The OEIS LLM context file is generated by building the `oeisLlmContext` package defined in the `nix-llm-context` flake.

**Command:**
```bash
nix build /data/data/com.termux.nix/files/home/pick-up-nix2/source/github/meta-introspector/streamofrandom/2025/09/22/nix-llm-context#oeisLlmContext
```

### 4.3. Script Functionality (Orchestrated by Nix)

The Nix build process performs the following:

1.  **Invokes `debug_wrapper.sh`**: The `flake.nix`'s `buildCommand` executes `debug_wrapper.sh`, passing various parameters to it.
2.  **Parses Arguments**: `debug_wrapper.sh` parses these arguments, including the path to `generate_oeis_llm_txt.sh`, the symbol ("OEIS"), the HTML file path, keyword script path, links file path, tutorial pattern, output directory, and main project path.
3.  **Executes `generate_oeis_llm_txt.sh`**: `debug_wrapper.sh` then executes `generate_oeis_llm_txt.sh` with the parsed arguments.
4.  **Generates LLM Context**: `generate_oeis_llm_txt.sh` performs the following:
    -   Creates a header for the LLM context file.
    -   Includes the full content of the `Online_Encyclopedia_of_Integer_Sequences.html` Wikipedia page.
    -   Attempts to extract meaningful keywords using `extract_meaningful_keywords.sh`.
    -   Attempts to find and include related links from `all_extracted_links.md`.
    -   Searches for and includes paths to related tutorials based on the provided pattern.
    -   Combines all this information into a single `llm-context-OEIS.txt` file within the Nix build's output directory.

## 5. Verification

After a successful Nix build, the generated LLM context file will be available via a `result` symlink in the current working directory.

**Command to view content:**
```bash
cat result/llm-context-OEIS.txt
```

Review the content to ensure it contains the expected Wikipedia content, and that keywords, links, and tutorials are extracted as anticipated.

## 6. Related Files

-   `/data/data/com.termux.nix/files/home/pick-up-nix2/source/github/meta-introspector/streamofrandom/2025/09/22/nix-llm-context/flake.nix`: Defines the Nix package for generating the OEIS LLM context.
-   `/data/data/com.termux.nix/files/home/pick-up-nix2/source/github/meta-introspector/streamofrandom/2025/09/22/nix-llm-context/debug_wrapper.sh`: Wrapper script for executing `generate_oeis_llm_txt.sh` within the Nix build environment.
-   `/data/data/com.termux.nix/files/home/pick-up-nix2/wikipedia_cache/Online_Encyclopedia_of_Integer_Sequences.html`: The source Wikipedia HTML file.
-   `/data/data/com.termux.nix/files/home/pick-up-nix2/docs/memes/extract_meaningful_keywords.sh`: Script used for keyword extraction.
-   `/data/data/com.termux.nix/files/home/pick-up-nix2/docs/memes/all_extracted_links.md`: File containing extracted links.
